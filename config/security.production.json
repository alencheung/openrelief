{
  "security": {
    "headers": {
      "strictTransportSecurity": {
        "enabled": true,
        "maxAge": 31536000,
        "includeSubDomains": true,
        "preload": true
      },
      "contentSecurityPolicy": {
        "enabled": true,
        "directives": {
          "default-src": ["'self'"],
          "script-src": ["'self'", "'unsafe-inline'", "'unsafe-eval'", "https://cdn.vercel-insights.com", "https://browser.sentry-cdn.com"],
          "style-src": ["'self'", "'unsafe-inline'", "https://fonts.googleapis.com"],
          "font-src": ["'self'", "https://fonts.gstatic.com"],
          "img-src": ["'self'", "data:", "https:", "blob:"],
          "connect-src": ["'self'", "https://api.openrelief.org", "https://openrelief.supabase.co", "https://dispatch.openrelief.org", "wss://openrelief.supabase.co"],
          "media-src": ["'self'", "blob:"],
          "object-src": ["'none'"],
          "child-src": ["'self'"],
          "frame-src": ["'none'"],
          "worker-src": ["'self'", "blob:"],
          "manifest-src": ["'self'"],
          "base-uri": ["'self'"],
          "form-action": ["'self'"],
          "frame-ancestors": ["'none'"],
          "upgrade-insecure-requests": []
        },
        "reportUri": "https://openrelief.report-uri.com"
      },
      "xFrameOptions": {
        "enabled": true,
        "value": "DENY"
      },
      "xContentTypeOptions": {
        "enabled": true,
        "value": "nosniff"
      },
      "referrerPolicy": {
        "enabled": true,
        "value": "strict-origin-when-cross-origin"
      },
      "permissionsPolicy": {
        "enabled": true,
        "directives": {
          "camera": ["'self'"],
          "microphone": ["'self'"],
          "geolocation": ["'self'"],
          "accelerometer": ["'none'"],
          "ambient-light-sensor": ["'none'"],
          "autoplay": ["'self'"],
          "battery": ["'none'"],
          "cross-origin-isolated": ["'none'"],
          "display-capture": ["'none'"],
          "document-domain": ["'none'"],
          "encrypted-media": ["'self'"],
          "execution-while-not-rendered": ["'none'"],
          "execution-while-out-of-viewport": ["'none'"],
          "fullscreen": ["'self'"],
          "gamepad": ["'self'"],
          "gyroscope": ["'none'"],
          "magnetometer": ["'none'"],
          "microphone": ["'self'"],
          "midi": ["'none'"],
          "navigation-override": ["'none'"],
          "payment": ["'self'"],
          "picture-in-picture": ["'self'"],
          "publickey-credentials-get": ["'self'"],
          "screen-wake-lock": ["'self'"],
          "sync-xhr": ["'self'"],
          "usb": ["'none'"],
          "xr-spatial-tracking": ["'none'"]
        }
      },
      "crossOriginEmbedderPolicy": {
        "enabled": true,
        "value": "require-corp"
      },
      "crossOriginOpenerPolicy": {
        "enabled": true,
        "value": "same-origin"
      },
      "crossOriginResourcePolicy": {
        "enabled": true,
        "value": "same-origin"
      }
    },
    "rateLimiting": {
      "enabled": true,
      "windowMs": 900000,
      "maxRequests": 100,
      "message": "Too many requests from this IP, please try again later.",
      "standardHeaders": true,
      "legacyHeaders": false,
      "skipSuccessfulRequests": false,
      "skipFailedRequests": false,
      "keyGenerator": "ip"
    },
    "cors": {
      "enabled": true,
      "origin": ["https://openrelief.org", "https://www.openrelief.org", "https://app.openrelief.org"],
      "methods": ["GET", "POST", "PUT", "DELETE", "OPTIONS"],
      "allowedHeaders": ["Content-Type", "Authorization", "X-Requested-With", "X-Client-Version"],
      "exposedHeaders": ["X-Total-Count", "X-Rate-Limit-Limit", "X-Rate-Limit-Remaining"],
      "credentials": true,
      "maxAge": 86400
    },
    "helmet": {
      "enabled": true,
      "contentSecurityPolicy": {
        "directives": {
          "defaultSrc": ["'self'"],
          "scriptSrc": ["'self'", "'unsafe-inline'", "'unsafe-eval'", "https://cdn.vercel-insights.com"],
          "styleSrc": ["'self'", "'unsafe-inline'", "https://fonts.googleapis.com"],
          "fontSrc": ["'self'", "https://fonts.gstatic.com"],
          "imgSrc": ["'self'", "data:", "https:", "blob:"],
          "connectSrc": ["'self'", "https://api.openrelief.org", "https://openrelief.supabase.co"],
          "mediaSrc": ["'self'", "blob:"],
          "objectSrc": ["'none'"],
          "childSrc": ["'self'"],
          "frameSrc": ["'none'"],
          "workerSrc": ["'self'", "blob:"],
          "manifestSrc": ["'self'"],
          "baseUri": ["'self'"],
          "formAction": ["'self'"],
          "frameAncestors": ["'none'"],
          "upgradeInsecureRequests": []
        }
      },
      "crossOriginEmbedderPolicy": true,
      "crossOriginOpenerPolicy": true,
      "crossOriginResourcePolicy": { "policy": "same-origin" },
      "dnsPrefetchControl": { "allow": false },
      "frameguard": { "action": "deny" },
      "hidePoweredBy": true,
      "hsts": {
        "maxAge": 31536000,
        "includeSubDomains": true,
        "preload": true
      },
      "ieNoOpen": true,
      "noSniff": true,
      "originAgentCluster": true,
      "permittedCrossDomainPolicies": false,
      "referrerPolicy": { "policy": "strict-origin-when-cross-origin" },
      "xssFilter": true
    }
  },
  "ssl": {
    "enabled": true,
    "protocol": "TLSv1.2",
    "ciphers": [
      "ECDHE-ECDSA-AES128-GCM-SHA256",
      "ECDHE-RSA-AES128-GCM-SHA256",
      "ECDHE-ECDSA-AES256-GCM-SHA384",
      "ECDHE-RSA-AES256-GCM-SHA384",
      "ECDHE-ECDSA-CHACHA20-POLY1305",
      "ECDHE-RSA-CHACHA20-POLY1305",
      "DHE-RSA-AES128-GCM-SHA256",
      "DHE-RSA-AES256-GCM-SHA384"
    ],
    "honorCipherOrder": true,
    "secureOptions": "SSL_OP_NO_SSLv3|SSL_OP_NO_TLSv1|SSL_OP_NO_TLSv1_1",
    "certificates": {
      "primary": {
        "path": "/etc/ssl/certs/openrelief.org.crt",
        "keyPath": "/etc/ssl/private/openrelief.org.key",
        "caPath": "/etc/ssl/certs/ca-bundle.crt"
      },
      "backup": {
        "path": "/etc/ssl/certs/openrelief-backup.org.crt",
        "keyPath": "/etc/ssl/private/openrelief-backup.org.key"
      }
    },
    "ocspStapling": true,
    "sessionTickets": true,
    "sessionTimeout": 300,
    "preferServerCiphers": true
  },
  "encryption": {
    "enabled": true,
    "algorithm": "AES-256-GCM",
    "keyRotation": {
      "enabled": true,
      "interval": "30d",
      "retention": "90d"
    },
    "atRest": {
      "enabled": true,
      "keyManagement": "AWS-KMS",
      "keyId": "arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012"
    },
    "inTransit": {
      "enabled": true,
      "tlsVersion": "1.3",
      "forwardSecrecy": true
    }
  },
  "authentication": {
    "jwt": {
      "algorithm": "HS256",
      "expiresIn": "1h",
      "issuer": "openrelief.org",
      "audience": "openrelief-users",
      "secretRotation": {
        "enabled": true,
        "interval": "90d"
      }
    },
    "password": {
      "minLength": 12,
      "requireUppercase": true,
      "requireLowercase": true,
      "requireNumbers": true,
      "requireSpecialChars": true,
      "maxAge": "90d",
      "historyCount": 12,
      "lockoutThreshold": 5,
      "lockoutDuration": "15m"
    },
    "mfa": {
      "enabled": true,
      "methods": ["totp", "sms", "email"],
      "backupCodes": {
        "enabled": true,
        "count": 10,
        "length": 8
      }
    },
    "session": {
      "timeout": "24h",
      "refreshThreshold": "1h",
      "maxConcurrent": 3,
      "secure": true,
      "httpOnly": true,
      "sameSite": "strict"
    }
  },
  "inputValidation": {
    "enabled": true,
    "sanitization": {
      "html": true,
      "sql": true,
      "xss": true,
      "ldap": true,
      "xpath": true,
      "xml": true
    },
    "validation": {
      "email": {
        "pattern": "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$",
        "maxLength": 254
      },
      "phone": {
        "pattern": "^\\+?[1-9]\\d{1,14}$",
        "maxLength": 15
      },
      "username": {
        "pattern": "^[a-zA-Z0-9_-]{3,30}$",
        "maxLength": 30
      },
      "emergency": {
        "title": {
          "maxLength": 200,
          "minLength": 5
        },
        "description": {
          "maxLength": 2000,
          "minLength": 10
        },
        "location": {
          "required": true,
          "validateCoordinates": true
        },
        "severity": {
          "min": 1,
          "max": 10
        },
        "radius": {
          "min": 100,
          "max": 50000
        }
      }
    }
  },
  "apiSecurity": {
    "enabled": true,
    "keyValidation": {
      "enabled": true,
      "length": 32,
      "rotation": "30d"
    },
    "requestSigning": {
      "enabled": true,
      "algorithm": "HMAC-SHA256",
      "header": "X-Signature"
    },
    "ipWhitelist": {
      "enabled": true,
      "adminEndpoints": ["0.0.0.0/0"], // Allow all for now, restrict in production
      "apiEndpoints": ["0.0.0.0/0"]
    },
    "requestLimits": {
      "maxPayloadSize": "10MB",
      "maxUrlLength": 2048,
      "maxHeaderSize": 8192
    }
  },
  "logging": {
    "enabled": true,
    "level": "info",
    "format": "json",
    "security": {
      "logFailedAuth": true,
      "logSuspiciousActivity": true,
      "logRateLimiting": true,
      "logInputValidation": true,
      "sanitizeLogs": true,
      "excludeSensitiveData": true
    },
    "retention": {
      "accessLogs": "90d",
      "securityLogs": "365d",
      "errorLogs": "180d"
    }
  },
  "monitoring": {
    "enabled": true,
    "security": {
      "enabled": true,
      "alerts": {
        "bruteForce": {
          "enabled": true,
          "threshold": 5,
          "window": "5m"
        },
        "ddos": {
          "enabled": true,
          "threshold": 1000,
          "window": "1m"
        },
        "injection": {
          "enabled": true,
          "patterns": ["sql", "xss", "ldap", "xpath"]
        },
        "anomalousAccess": {
          "enabled": true,
          "baseline": "7d",
          "threshold": 3
        }
      }
    },
    "compliance": {
      "enabled": true,
      "gdpr": {
        "dataRetention": "365d",
        "rightToBeForgotten": true,
        "dataPortability": true,
        "consentManagement": true
      },
      "ccpa": {
        "dataRetention": "365d",
        "rightToOptOut": true,
        "dataPortability": true
      },
      "hipaa": {
        "enabled": false,
        "auditLogging": true,
        "accessControls": true
      }
    }
  },
  "backup": {
    "enabled": true,
    "encryption": {
      "enabled": true,
      "algorithm": "AES-256-GCM",
      "keyManagement": "AWS-KMS"
    },
    "retention": {
      "daily": 30,
      "weekly": 12,
      "monthly": 24,
      "yearly": 7
    },
    "testing": {
      "enabled": true,
      "frequency": "weekly",
      "restoreTest": true
    }
  },
  "disasterRecovery": {
    "enabled": true,
    "rto": "4h", // Recovery Time Objective
    "rpo": "1h", // Recovery Point Objective
    "failover": {
      "enabled": true,
      "automatic": true,
      "healthCheckInterval": "30s",
      "failoverThreshold": 3
    },
    "dataReplication": {
      "enabled": true,
      "multiRegion": true,
      "regions": ["us-east-1", "eu-west-1", "ap-southeast-1"],
      "replicationLag": "5m"
    }
  }
}