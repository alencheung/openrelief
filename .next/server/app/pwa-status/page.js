(()=>{var e={};e.id=514,e.ids=[514],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},2835:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,pages:()=>d,routeModule:()=>x,tree:()=>o});var a=s(260),n=s(8203),r=s(5155),i=s.n(r),l=s(7292),c={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(t,c);let o=["",{children:["pwa-status",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,701)),"C:\\Users\\alen_\\SynologyDrive\\SourceCode\\openrelief\\src\\app\\pwa-status\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1354)),"C:\\Users\\alen_\\SynologyDrive\\SourceCode\\openrelief\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9937,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\alen_\\SynologyDrive\\SourceCode\\openrelief\\src\\app\\pwa-status\\page.tsx"],m={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/pwa-status/page",pathname:"/pwa-status",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},9579:(e,t,s)=>{Promise.resolve().then(s.bind(s,8450))},195:(e,t,s)=>{Promise.resolve().then(s.bind(s,6015))},3100:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3258).A)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},3522:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3258).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},4643:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3258).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},2557:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(3258).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},6015:(e,t,s)=>{"use strict";s.d(t,{PWAStatus:()=>A});var a=s(5512),n=s(8009),r=s(8542),i=s(7272);class l{static getInstance(){return l.instance||(l.instance=new l),l.instance}async getCacheInfo(){let e=await caches.keys(),t=[];for(let s of e){let e=await caches.open(s),a=await e.keys(),n=0;for(let t of a.slice(0,10)){let s=await e.match(t);if(s){let e=s.clone();n+=(await e.arrayBuffer()).byteLength}}let r=Math.round(n/Math.min(a.length,10)*a.length);t.push({name:s,size:r,entries:a.length,lastModified:new Date})}return t}async clearCache(e){if(e)await caches.delete(e);else{let e=await caches.keys();await Promise.all(e.map(e=>caches.delete(e)))}}async preloadCriticalAssets(){let e=await caches.open(this.cacheNames.static);try{await e.addAll(["/","/offline","/offline/emergency","/manifest.json","/icons/icon-192x192.png","/icons/icon-512x512.png"].map(e=>new Request(e,{cache:"no-cache"}))),console.log("[PWA] Critical assets preloaded successfully")}catch(e){console.error("[PWA] Failed to preload critical assets:",e)}}async estimateStorageUsage(){if("storage"in navigator&&"estimate"in navigator.storage){let e=await navigator.storage.estimate();return{used:Number(e.usage)||0,quota:Number(e.quota)||0,percentage:(Number(e.usage)||0)/(Number(e.quota)||1)*100}}return{used:0,quota:0,percentage:0}}constructor(){this.cacheNames={static:"openrelief-static-v2.0.0",dynamic:"openrelief-dynamic-v2.0.0",emergency:"openrelief-emergency-v2.0.0",offline:"openrelief-offline-v2.0.0"}}}class c{static getInstance(){return c.instance||(c.instance=new c),c.instance}async initDB(){if(!this.db)return new Promise((e,t)=>{let s=indexedDB.open("OpenReliefOffline",2);s.onerror=()=>t(s.error),s.onsuccess=()=>{this.db=s.result,e()},s.onupgradeneeded=e=>{let t=e.target.result;if(!t.objectStoreNames.contains("actions")){let e=t.createObjectStore("actions",{keyPath:"id"});e.createIndex("timestamp","timestamp",{unique:!1}),e.createIndex("type","type",{unique:!1}),e.createIndex("synced","synced",{unique:!1})}if(!t.objectStoreNames.contains("emergencyData")){let e=t.createObjectStore("emergencyData",{keyPath:"id"});e.createIndex("type","type",{unique:!1}),e.createIndex("timestamp","timestamp",{unique:!1})}t.objectStoreNames.contains("settings")||t.createObjectStore("settings",{keyPath:"key"})}})}async saveAction(e){return await this.initDB(),new Promise((t,s)=>{let a=this.db.transaction(["actions"],"readwrite").objectStore("actions").add(e);a.onerror=()=>s(a.error),a.onsuccess=()=>t()})}async getActions(e,t=!1){return await this.initDB(),new Promise((s,a)=>{let n=this.db.transaction(["actions"],"readonly").objectStore("actions").getAll();n.onerror=()=>a(n.error),n.onsuccess=()=>{let a=n.result;e&&(a=a.filter(t=>t.type===e)),s(a=a.filter(e=>e.synced===t))}})}async markActionSynced(e){return await this.initDB(),new Promise((t,s)=>{let a=this.db.transaction(["actions"],"readwrite").objectStore("actions"),n=a.get(e);n.onerror=()=>s(n.error),n.onsuccess=()=>{let e=n.result;if(e){e.synced=!0;let n=a.put(e);n.onerror=()=>s(n.error),n.onsuccess=()=>t()}}})}async saveEmergencyData(e){return await this.initDB(),new Promise((t,s)=>{let a=this.db.transaction(["emergencyData"],"readwrite").objectStore("emergencyData").put({...e,id:`emergency_${Date.now()}`,timestamp:Date.now()});a.onerror=()=>s(a.error),a.onsuccess=()=>t()})}async getEmergencyData(e){return await this.initDB(),new Promise((t,s)=>{let a=this.db.transaction(["emergencyData"],"readonly").objectStore("emergencyData").getAll();a.onerror=()=>s(a.error),a.onsuccess=()=>{let s=a.result;e&&(s=s.filter(t=>t.type===e)),t(s)}})}constructor(){this.db=null}}class o{static isOnline(){return navigator.onLine}static getConnectionType(){if("connection"in navigator){let e=navigator.connection;return e?.effectiveType||e?.type||null}return null}static async testConnectivity(e="/api/health"){try{return(await fetch(e,{cache:"no-cache",signal:AbortSignal.timeout(5e3)})).ok}catch{return!1}}static async getNetworkQuality(){if("connection"in navigator){let e=navigator.connection;return{effectiveType:e.effectiveType||"unknown",downlink:e.downlink||0,rtt:e.rtt||0,saveData:e.saveData||!1}}return{effectiveType:"unknown",downlink:0,rtt:0,saveData:!1}}}class d{static async measurePageLoad(){return new Promise(e=>{let t=performance.getEntriesByType("navigation")[0],s={domContentLoaded:t.domContentLoadedEventEnd-t.domContentLoadedEventStart,loadComplete:t.loadEventEnd-t.loadEventStart};if("PerformanceObserver"in window)try{new PerformanceObserver(t=>{for(let e of t.getEntries())"first-contentful-paint"===e.name?s.firstContentfulPaint=e.startTime:"largest-contentful-paint"===e.name&&(s.largestContentfulPaint=e.startTime);e(s)}).observe({entryTypes:["paint","largest-contentful-paint"]}),setTimeout(()=>e(s),5e3)}catch{e(s)}else e(s)})}static async getCacheHitRate(){try{let e=performance.getEntriesByType("navigation")[0],t=e.transferSize||0,s=e.encodedBodySize||0;if(0===t&&0===s)return 100;if(0===s)return 0;return Math.max(0,100-t/s*100)}catch{return 0}}}function m(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}function x(e){let t=Math.floor(e/1e3),s=Math.floor(t/60),a=Math.floor(s/60);return a>0?`${a}h ${s%60}m`:s>0?`${s}m ${t%60}s`:`${t}s`}var u=s(2557),g=s(4736),h=s(8996),p=s(3258);let y=(0,p.A)("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),f=(0,p.A)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),v=(0,p.A)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);var j=s(4643);let w=(0,p.A)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);var N=s(3100),b=s(3522);function A(){let[e,t]=(0,n.useState)(!0),[s,p]=(0,n.useState)([]),[A,k]=(0,n.useState)({used:0,quota:0,percentage:0}),[C,P]=(0,n.useState)({}),[S,M]=(0,n.useState)({}),[D,q]=(0,n.useState)([]),[T,_]=(0,n.useState)(!1),E=async()=>{try{let e=l.getInstance(),t=await e.getCacheInfo();p(t);let s=await e.estimateStorageUsage();k(s);let a=await o.getNetworkQuality();P(a);let n=await d.measurePageLoad();M(n);let r=c.getInstance(),i=await r.getActions();q(i.filter(e=>!e.synced))}catch(e){console.error("Failed to load PWA status:",e)}},L=async()=>{_(!0),await E(),_(!1)},B=async e=>{try{let t=l.getInstance();await t.clearCache(e),await E()}catch(e){console.error("Failed to clear cache:",e)}},$=async()=>{try{let e=l.getInstance();await e.preloadCriticalAssets(),await E()}catch(e){console.error("Failed to preload assets:",e)}},I=e=>e<1e3?{grade:"A",color:"text-green-600"}:e<2e3?{grade:"B",color:"text-yellow-600"}:e<3e3?{grade:"C",color:"text-orange-600"}:{grade:"D",color:"text-red-600"};return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"PWA Status"}),(0,a.jsxs)(i.$,{onClick:L,disabled:T,variant:"outline",children:[(0,a.jsx)(u.A,{className:`h-4 w-4 mr-2 ${T?"animate-spin":""}`}),"Refresh"]})]}),(0,a.jsxs)(r.Zp,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[e?(0,a.jsx)(g.A,{className:"h-6 w-6 text-green-600"}):(0,a.jsx)(h.A,{className:"h-6 w-6 text-red-600"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Network Status"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Connection"}),(0,a.jsx)("div",{className:"text-lg font-medium",children:e?"Online":"Offline"})]}),(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Effective Type"}),(0,a.jsx)("div",{className:`text-lg font-medium ${(e=>{switch(e){case"4g":return"text-green-600";case"3g":return"text-yellow-600";case"2g":return"text-orange-600";case"slow-2g":return"text-red-600";default:return"text-gray-600"}})(C.effectiveType)}`,children:C.effectiveType?.toUpperCase()||"Unknown"})]}),(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Downlink"}),(0,a.jsx)("div",{className:"text-lg font-medium",children:C.downlink?`${C.downlink} Mbps`:"Unknown"})]})]})]}),(0,a.jsxs)(r.Zp,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,a.jsx)(y,{className:"h-6 w-6 text-blue-600"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Storage Status"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Storage Usage"}),(0,a.jsxs)("span",{className:"text-sm font-medium",children:[m(A.used)," / ",m(A.quota)]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:`h-2 rounded-full ${A.percentage>80?"bg-red-600":A.percentage>60?"bg-yellow-600":"bg-green-600"}`,style:{width:`${Math.min(A.percentage,100)}%`}})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Queued Actions"}),(0,a.jsxs)("div",{className:"text-lg font-medium text-orange-600",children:[D.length," items"]})]}),(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Cache Entries"}),(0,a.jsxs)("div",{className:"text-lg font-medium",children:[s.reduce((e,t)=>e+t.entries,0)," items"]})]})]})]})]}),(0,a.jsxs)(r.Zp,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(f,{className:"h-6 w-6 text-purple-600"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Cache Status"})]}),(0,a.jsxs)("div",{className:"space-x-2",children:[(0,a.jsx)(i.$,{onClick:$,size:"sm",variant:"outline",children:"Preload Assets"}),(0,a.jsxs)(i.$,{onClick:()=>B(),size:"sm",variant:"outline",children:[(0,a.jsx)(v,{className:"h-4 w-4 mr-1"}),"Clear All"]})]})]}),(0,a.jsx)("div",{className:"space-y-3",children:s.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[e.entries," entries • ",m(e.size)]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.A,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:e.lastModified.toLocaleTimeString()}),(0,a.jsx)(i.$,{onClick:()=>B(e.name),size:"sm",variant:"ghost",children:(0,a.jsx)(v,{className:"h-4 w-4"})})]})]},t))})]}),(0,a.jsxs)(r.Zp,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,a.jsx)(w,{className:"h-6 w-6 text-green-600"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Performance"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Page Load Time"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-lg font-medium",children:S.loadComplete?x(S.loadComplete):"N/A"}),S.loadComplete&&(0,a.jsxs)("span",{className:`text-sm font-medium ${I(S.loadComplete).color}`,children:["Grade ",I(S.loadComplete).grade]})]})]}),(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"DOM Content Loaded"}),(0,a.jsx)("div",{className:"text-lg font-medium",children:S.domContentLoaded?x(S.domContentLoaded):"N/A"})]}),(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"First Contentful Paint"}),(0,a.jsx)("div",{className:"text-lg font-medium",children:S.firstContentfulPaint?x(S.firstContentfulPaint):"N/A"})]}),(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Largest Contentful Paint"}),(0,a.jsx)("div",{className:"text-lg font-medium",children:S.largestContentfulPaint?x(S.largestContentfulPaint):"N/A"})]})]})]}),D.length>0&&(0,a.jsxs)(r.Zp,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,a.jsx)(j.A,{className:"h-6 w-6 text-orange-600"}),(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Queued Actions (",D.length,")"]})]}),(0,a.jsx)("div",{className:"space-y-3",children:D.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.type}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[e.endpoint," • ",new Date(e.timestamp).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(N.A,{className:"h-4 w-4 text-orange-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-orange-600",children:"Pending"})]})]},t))}),(0,a.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(b.A,{className:"h-5 w-5 text-blue-600"}),(0,a.jsx)("p",{className:"text-sm text-blue-800",children:"These actions will be automatically synced when you regain internet connection."})]})})]})]})}},701:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i,metadata:()=>r});var a=s(2740),n=s(8450);let r={title:"PWA Status - OpenRelief",description:"OpenRelief PWA status and diagnostics",robots:"noindex, nofollow"};function i(){return(0,a.jsx)(n.PWAStatus,{})}},8450:(e,t,s)=>{"use strict";s.d(t,{PWAStatus:()=>a});let a=(0,s(6760).registerClientReference)(function(){throw Error("Attempted to call PWAStatus() from the server but PWAStatus is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\alen_\\SynologyDrive\\SourceCode\\openrelief\\src\\components\\pwa\\PWAStatus.tsx","PWAStatus")}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[677,446],()=>s(2835));module.exports=a})();