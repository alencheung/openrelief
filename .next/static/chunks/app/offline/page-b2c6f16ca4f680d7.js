(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[734],{6655:(e,s,a)=>{Promise.resolve().then(a.bind(a,6695))},6695:(e,s,a)=>{"use strict";a.d(s,{OfflineFallback:()=>x});var t=a(5155),n=a(2115),l=a(6782),c=a(6675),i=a(4450),r=a(7564),o=a(878),d=a(1836),m=a(1773);function x(){let{isOnline:e,reconnectAttempts:s}=(0,l.M)(),[a,x]=(0,n.useState)(!1),[h,f]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=localStorage.getItem("openrelief-last-sync");e&&f(new Date(e))},[]);let p=async()=>{x(!0);try{(await fetch("/api/health",{cache:"no-cache",signal:AbortSignal.timeout(5e3)})).ok&&window.location.reload()}catch(e){console.error("Retry failed:",e)}finally{x(!1)}},u=[{title:"Report Emergency",description:"File an emergency report (will sync when online)",icon:r.A,action:()=>window.location.href="/report",available:!0},{title:"View Offline Map",description:"Access cached map data and locations",icon:o.A,action:()=>window.location.href="/offline/map",available:!0},{title:"Emergency Contacts",description:"View cached emergency contact information",icon:o.A,action:()=>window.location.href="/offline/contacts",available:!0}];return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:(0,t.jsxs)("div",{className:"max-w-md w-full space-y-6",children:[(0,t.jsxs)(i.Zp,{className:"p-6 text-center",children:[(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)("div",{className:"p-3 rounded-full ".concat(e?"bg-green-100":"bg-red-100"),children:e?(0,t.jsx)(o.A,{className:"h-8 w-8 text-green-600"}):(0,t.jsx)(d.A,{className:"h-8 w-8 text-red-600"})})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:e?"Connection Restored":"You're Offline"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:e?"Your connection has been restored. You can continue using OpenRelief.":"OpenRelief is working offline. Emergency features remain available."}),!e&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(c.$,{onClick:p,disabled:a,className:"w-full",variant:"outline",children:a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Checking Connection..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Retry Connection"]})}),s>0&&(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["Reconnect attempts: ",s]})]})]}),(0,t.jsxs)(i.Zp,{className:"p-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Emergency Actions Available Offline"}),(0,t.jsx)("div",{className:"space-y-3",children:u.map((e,s)=>(0,t.jsxs)(c.$,{onClick:e.action,variant:"ghost",className:"w-full justify-start h-auto p-3",disabled:!e.available,children:[(0,t.jsx)(e.icon,{className:"h-5 w-5 mr-3 flex-shrink-0"}),(0,t.jsxs)("div",{className:"text-left",children:[(0,t.jsx)("div",{className:"font-medium",children:e.title}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:e.description})]})]},s))})]}),(0,t.jsx)(i.Zp,{className:"p-4 bg-blue-50 border-blue-200",children:(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)(r.A,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),(0,t.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,t.jsx)("p",{className:"font-medium mb-1",children:"Offline Mode Active"}),(0,t.jsx)("p",{className:"text-blue-700",children:"OpenRelief continues to work offline for 24+ hours. Your emergency reports and actions will be synced automatically when you reconnect."}),h&&(0,t.jsxs)("p",{className:"text-blue-600 mt-2 text-xs",children:["Last sync: ",h.toLocaleString()]})]})]})}),(0,t.jsxs)("div",{className:"text-center text-xs text-gray-500",children:[(0,t.jsx)("p",{children:"OpenRelief Emergency Platform v2.0.0"}),(0,t.jsx)("p",{children:"Offline-capable PWA"})]})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[76,96,358],()=>s(6655)),_N_E=e.O()}]);