(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[504],{6133:(e,s,l)=>{Promise.resolve().then(l.bind(l,7969))},7969:(e,s,l)=>{"use strict";l.d(s,{OfflineEmergencyPage:()=>y});var a=l(9233),t=l(5843),r=l(5155),c=l(2115),n=l(6782),i=l(6675),d=l(4450),o=l(1836),m=l(7564),x=l(7223),u=l(3831),p=l(6889),h=l(878);let g=[{value:"medical",label:"Medical Emergency",icon:"\uD83D\uDE91"},{value:"fire",label:"Fire",icon:"\uD83D\uDD25"},{value:"police",label:"Police Emergency",icon:"\uD83D\uDE94"},{value:"rescue",label:"Rescue Operation",icon:"\uD83D\uDE81"},{value:"shelter",label:"Shelter Needed",icon:"\uD83C\uDFE0"},{value:"supplies",label:"Emergency Supplies",icon:"\uD83D\uDCE6"},{value:"other",label:"Other Emergency",icon:"⚠️"}],b=[{value:"low",label:"Low",color:"bg-yellow-100 text-yellow-800"},{value:"medium",label:"Medium",color:"bg-orange-100 text-orange-800"},{value:"high",label:"High",color:"bg-red-100 text-red-800"},{value:"critical",label:"Critical",color:"bg-red-200 text-red-900"}];function y(){let{queueOfflineAction:e,getQueuedActions:s}=(0,n.G)(),[l,y]=(0,c.useState)({type:"",severity:"medium",description:"",location:"",contact:""}),[v,j]=(0,c.useState)(!1),[f,N]=(0,c.useState)([]),w=async s=>{if(s.preventDefault(),!l.type||!l.description){alert("Please fill in all required fields");return}j(!0);try{let s={id:"offline_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),type:l.type,severity:l.severity,description:l.description,location:l.location,contact:l.contact,timestamp:Date.now(),synced:!1};await e({type:"emergency_report",data:s,endpoint:"/api/emergencies",method:"POST"}),N(e=>[s,...e]),y({type:"",severity:"medium",description:"",location:"",contact:""}),alert("Emergency report saved offline. It will be sent when you reconnect.")}catch(e){console.error("Failed to save emergency report:",e),alert("Failed to save emergency report. Please try again.")}finally{j(!1)}},_=async()=>{try{let e=(await s()).filter(e=>"emergency_report"===e.type).map(e=>e.data);N(e)}catch(e){console.error("Failed to load queued reports:",e)}};(0,c.useState)(()=>{_()});let E=e=>{let s=g.find(s=>s.value===e);return(null==s?void 0:s.icon)||"⚠️"},C=e=>{let s=b.find(s=>s.value===e);return(null==s?void 0:s.color)||"bg-gray-100 text-gray-800"};return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"flex justify-center mb-4",children:(0,r.jsx)("div",{className:"p-3 bg-red-100 rounded-full",children:(0,r.jsx)(o.A,{className:"h-8 w-8 text-red-600"})})}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Emergency Mode (Offline)"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Report emergencies even without internet connection. Reports will sync automatically when you're back online."})]}),(0,r.jsxs)(d.Zp,{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-6",children:[(0,r.jsx)(m.A,{className:"h-6 w-6 text-red-600"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Report Emergency"})]}),(0,r.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Emergency Type *"}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:g.map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>y(s=>(0,t._)((0,a._)({},s),{type:e.value})),className:"p-3 text-center rounded-lg border-2 transition-colors ".concat(l.type===e.value?"border-red-500 bg-red-50":"border-gray-200 hover:border-gray-300"),children:[(0,r.jsx)("div",{className:"text-2xl mb-1",children:e.icon}),(0,r.jsx)("div",{className:"text-xs font-medium",children:e.label})]},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Severity Level"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:b.map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>y(s=>(0,t._)((0,a._)({},s),{severity:e.value})),className:"px-3 py-1 rounded-full text-sm font-medium transition-colors ".concat(l.severity===e.value?e.color:"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,r.jsx)("textarea",{value:l.description,onChange:e=>y(s=>(0,t._)((0,a._)({},s),{description:e.target.value})),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Describe the emergency situation...",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)(x.A,{className:"inline h-4 w-4 mr-1"}),"Location"]}),(0,r.jsx)("input",{type:"text",value:l.location,onChange:e=>y(s=>(0,t._)((0,a._)({},s),{location:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Enter location or address..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)(u.A,{className:"inline h-4 w-4 mr-1"}),"Contact Information"]}),(0,r.jsx)("input",{type:"text",value:l.contact,onChange:e=>y(s=>(0,t._)((0,a._)({},s),{contact:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Phone number or email..."})]}),(0,r.jsx)(i.$,{type:"submit",disabled:v||!l.type||!l.description,className:"w-full bg-red-600 hover:bg-red-700",children:v?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving Offline..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Save Emergency Report (Offline)"]})})]})]}),f.length>0&&(0,r.jsxs)(d.Zp,{className:"p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Queued Emergency Reports (",f.length,")"]}),(0,r.jsx)("div",{className:"space-y-3",children:f.map(e=>{var s;return(0,r.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)("span",{className:"text-lg",children:E(e.type)}),(0,r.jsx)("span",{className:"font-medium text-gray-900",children:null===(s=g.find(s=>s.value===e.type))||void 0===s?void 0:s.label}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(C(e.severity)),children:e.severity.toUpperCase()})]}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mb-2",children:e.description}),e.location&&(0,r.jsxs)("p",{className:"text-gray-500 text-xs mb-1",children:[(0,r.jsx)(x.A,{className:"inline h-3 w-3 mr-1"}),e.location]}),(0,r.jsxs)("p",{className:"text-gray-500 text-xs",children:[(0,r.jsx)(p.A,{className:"inline h-3 w-3 mr-1"}),new Date(e.timestamp).toLocaleString()]})]}),(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsx)("div",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:"Queued"})})]})},e.id)})}),(0,r.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(h.A,{className:"h-5 w-5 text-blue-600"}),(0,r.jsx)("p",{className:"text-sm text-blue-800",children:"These reports will be automatically sent when you regain internet connection."})]})})]}),(0,r.jsxs)(d.Zp,{className:"p-6 bg-blue-50 border-blue-200",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Emergency Contacts (Cached)"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"p-2 bg-red-100 rounded-full",children:(0,r.jsx)(u.A,{className:"h-5 w-5 text-red-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:"Emergency Services"}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Call 911"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"p-2 bg-blue-100 rounded-full",children:(0,r.jsx)(u.A,{className:"h-5 w-5 text-blue-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:"Local Hospital"}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Call 555-0123"})]})]})]})]})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[76,96,358],()=>s(6133)),_N_E=e.O()}]);